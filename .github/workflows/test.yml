name: Test
on:
  push:
    branches:
      - 'test-workflow'
      
jobs:
  build:
    name: Test
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v2
      
      # - name: Check has changes
      #   id: has-changes
      #   uses: rdietrick/did-files-change@test-workflow
      #   with:
      #     sha: ${{ github.sha }}
      #     pathspec: .

      - name: Check has changes
        id: has-changes
        env:
          SHA: b6382e68e1042e4376ce5dcd78cefbcf6fa352b1
          PATHSPEC: "."
        run: |
          echo "SHA: $SHA"
          git log -1
          git diff-tree --no-commit-id --name-only -r $SHA
          if [[ -z "$(git diff-tree --no-commit-id --name-only -r $SHA $PATHSPEC)" ]]; then CHANGED="0"; else CHANGED="1"; fi
          echo "CHANGED: $CHANGED"
          #echo ::set-output name=changed::$CHANGED

      - name: Debug
        run: |
          echo "Has changes: ${{ steps.id.has-changes.outputs.changed }}"